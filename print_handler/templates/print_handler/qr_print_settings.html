{% extends "base.html" %}

{% block title %}QR Print Settings - ArmGuard{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1 class="page-title">QR Code Print Settings</h1>
        <p class="page-subtitle">Customize your QR code print layout</p>
    </div>

    <div class="card">
        <h2 class="card-title">Print Configuration</h2>
        <form id="printSettingsForm" action="{% url 'print_handler:generate_qr_pdf' %}" method="GET" target="_blank">
            <div class="form-grid">
                <!-- QR Type Selection -->
                <div class="form-group">
                    <label for="type">QR Code Type:</label>
                    <select name="type" id="type" class="form-control">
                        <option value="all">All QR Codes (Personnel & Items)</option>
                        <option value="personnel">Personnel Only</option>
                        <option value="items">Items Only</option>
                    </select>
                </div>

                <!-- Paper Size -->
                <div class="form-group">
                    <label for="paper">Paper Size:</label>
                    <select name="paper" id="paper" class="form-control">
                        <option value="A4" selected>A4 (210mm √ó 297mm)</option>
                        <option value="letter">US Letter (8.5" √ó 11")</option>
                    </select>
                </div>

                <!-- QR Code Size -->
                <div class="form-group">
                    <label for="qr_size">QR Code Size (mm):</label>
                    <input type="number" name="qr_size" id="qr_size" class="form-control" value="30" min="10" max="100">
                    <small class="form-text">Default: 30mm (~1.18 inches)</small>
                </div>

                <!-- Margin -->
                <div class="form-group">
                    <label for="margin">Page Margin (mm):</label>
                    <input type="number" name="margin" id="margin" class="form-control" value="15" min="5" max="50">
                    <small class="form-text">Space around the edges</small>
                </div>

                <!-- Columns -->
                <div class="form-group">
                    <label for="columns">Columns:</label>
                    <input type="number" name="columns" id="columns" class="form-control" value="3" min="1" max="10">
                    <small class="form-text">QR codes per row</small>
                </div>

                <!-- Rows -->
                <div class="form-group">
                    <label for="rows">Rows:</label>
                    <input type="number" name="rows" id="rows" class="form-control" value="5" min="1" max="15">
                    <small class="form-text">QR codes per column</small>
                </div>
            </div>

            <div class="form-actions" style="margin-top: 2rem; display: flex; gap: 1rem;">
                <button type="submit" class="btn btn-success">üìÑ Generate PDF</button>
                <button type="button" class="btn btn-secondary" onclick="resetToDefaults()">üîÑ Reset to Defaults</button>
            </div>

            <div class="info-box" style="margin-top: 2rem; padding: 1rem; background: #f0f8ff; border-left: 4px solid #0066cc; border-radius: 4px;">
                <h3 style="margin-top: 0; color: #0066cc;">‚ÑπÔ∏è Print Layout Preview</h3>
                <p id="layoutInfo" style="margin: 0.5rem 0; font-family: monospace;">
                    <strong>QR Codes per page:</strong> <span id="perPage">15</span><br>
                    <strong>Paper:</strong> <span id="paperInfo">A4</span><br>
                    <strong>QR Size:</strong> <span id="qrSizeInfo">30mm</span> √ó <span id="qrSizeInfo2">30mm</span>
                </p>
            </div>
        </form>
    </div>

    <div class="card" style="margin-top: 2rem;">
        <h2 class="card-title">Quick Presets</h2>
        <div class="preset-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
            <button class="preset-btn" onclick="applyPreset('standard')">
                <strong>üìÑ Standard</strong><br>
                <small>A4, 30mm QR, 3√ó5 grid</small>
            </button>
            <button class="preset-btn" onclick="applyPreset('compact')">
                <strong>üì¶ Compact</strong><br>
                <small>A4, 25mm QR, 4√ó6 grid</small>
            </button>
            <button class="preset-btn" onclick="applyPreset('large')">
                <strong>üîç Large</strong><br>
                <small>A4, 40mm QR, 2√ó4 grid</small>
            </button>
            <button class="preset-btn" onclick="applyPreset('us_letter')">
                <strong>üá∫üá∏ US Letter</strong><br>
                <small>Letter, 30mm QR, 3√ó5 grid</small>
            </button>
        </div>
    </div>
</div>

<style>
.form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
}

.form-group {
    display: flex;
    flex-direction: column;
}

.form-group label {
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: var(--text-color);
}

.form-control {
    padding: 0.75rem;
    border: 2px solid var(--border-color);
    border-radius: 6px;
    font-size: 1rem;
}

.form-control:focus {
    outline: none;
    border-color: var(--primary-color);
}

.form-text {
    margin-top: 0.25rem;
    color: var(--text-light);
    font-size: 0.875rem;
}

.preset-btn {
    padding: 1rem;
    background: white;
    border: 2px solid var(--border-color);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s;
}

.preset-btn:hover {
    border-color: var(--primary-color);
    background: var(--primary-light);
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.preset-btn strong {
    display: block;
    margin-bottom: 0.5rem;
    color: var(--primary-color);
}

.preset-btn small {
    color: var(--text-light);
}
</style>

<script>
const presets = {
    standard: { paper: 'A4', qr_size: 30, margin: 15, columns: 3, rows: 5 },
    compact: { paper: 'A4', qr_size: 25, margin: 10, columns: 4, rows: 6 },
    large: { paper: 'A4', qr_size: 40, margin: 20, columns: 2, rows: 4 },
    us_letter: { paper: 'letter', qr_size: 30, margin: 15, columns: 3, rows: 5 }
};

function applyPreset(presetName) {
    const preset = presets[presetName];
    document.getElementById('paper').value = preset.paper;
    document.getElementById('qr_size').value = preset.qr_size;
    document.getElementById('margin').value = preset.margin;
    document.getElementById('columns').value = preset.columns;
    document.getElementById('rows').value = preset.rows;
    updatePreview();
}

function resetToDefaults() {
    applyPreset('standard');
}

function updatePreview() {
    const columns = parseInt(document.getElementById('columns').value);
    const rows = parseInt(document.getElementById('rows').value);
    const qrSize = parseInt(document.getElementById('qr_size').value);
    const paper = document.getElementById('paper').value;
    
    const perPage = columns * rows;
    
    document.getElementById('perPage').textContent = perPage;
    document.getElementById('paperInfo').textContent = paper === 'A4' ? 'A4 (210mm √ó 297mm)' : 'US Letter (8.5" √ó 11")';
    document.getElementById('qrSizeInfo').textContent = qrSize + 'mm';
    document.getElementById('qrSizeInfo2').textContent = qrSize + 'mm';
}

// Update preview on input change
document.querySelectorAll('#printSettingsForm input, #printSettingsForm select').forEach(input => {
    input.addEventListener('change', updatePreview);
    input.addEventListener('input', updatePreview);
});

// Initial preview update
updatePreview();
</script>
{% endblock %}
